# Compile LaTeX Action

A GitHub Action that compiles all LaTeX documents in one shot, automatically, with minimal configuration, using (by default) the great [Rubber](https://gitlab.com/latex-rubber/rubber/) toolchain.

This action is meant to be as portable as possible, namely, it is meant to be written once and then delivered to multiple repositories with no changes (e.g., via [Autodelivery](https://github.com/marketplace/actions/autodelivery)).

To this end, this action scans your file system, searching for `.tex` files.
Unless a file has a magic comment similar to `% ! TeX root = ...`, then it is interpreted as a LaTeX root document and its compilation is attempted.

A list of compiled files is produced, so that it can easily be used to deploy them wherever you see fit.

The action installs Rubber autonomously, but expects you to have setup TeXLive correctly.
We recommend using the [Setup TeXLive action](https://github.com/marketplace/actions/setup-texlive) to do so.

## Usage examples

In the following examples, we show a workflow using this action to compile all `tex` files, and then deploying them as pdfs on GitHub Releases via `hub`.
The version is generated by the [SemVer Autotag action](https://github.com/marketplace/actions/semver-autotag).

```yaml
name: Build LaTeX and deploy on GH Releases
on:
  push:

jobs:
  Build-LaTeX:
    runs-on: ubuntu-latest
    steps:
      # Checkout the repository
      - name: Checkout
        uses: actions/checkout@v2
      - name: Install TeXLive
        uses: DanySK/setup-texlive-action@master
      - name: Compile LaTeX
        uses: DanySK/compile-latex-action@master
      - name: Autotag
        uses: DanySK/semver-autotag-action@master
      - name: Deploy
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          TAG=$(git describe --tags --exact-match HEAD)
          hub release create -m "$(git tag -l --format='%(contents)' "$TAG")" "$TAG" || true
          while IFS= read -r file; do
            pdf="${file%.*}.pdf"
            echo "Delivering file $pdf"
            hub release edit -m '' -a "$pdf" "$TAG"
          done <"success-list"
